ApiVersion: v0.13

Namespace: global
Resources:
  - Name: console.nanocl.internal
    Kind: ncproxy.io/rule/v0.13
    Data:
      Rules:
      - Network: All
        Locations:
        - Path: /
          Version: 1.1
          Headers:
          - Upgrade $http_upgrade
          - Connection "Upgrade"
          Target:
            Key: console.global.c
            Port: 3000
  - Name: nanocl.internal
    Kind: ncproxy.io/rule/v0.13
    Data:
      Rules:
        - Domain: nanocl.internal
          Port: 8585
          Network: All
          Locations:
            - Path: /
              Target:
                UnixPath: /run/nanocl/nanocl.sock
Cargoes:
  - Name: console
    Container:
      Image: node:23.11-slim
      Tty: true
      WorkingDir: /project
      Env:
        - HOST=0.0.0.0
      HostConfig:
        Binds:
          - ./:/project
      Cmd:
        - sh
        - -c
        - |
          npm install
          npm run dev
